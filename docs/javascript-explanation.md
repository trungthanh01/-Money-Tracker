# T√ÄI LI·ªÜU GI·∫¢I TH√çCH CHI TI·∫æT JAVASCRIPT CODE
*Gi·∫£i th√≠ch t·ª´ng file JavaScript theo ph∆∞∆°ng ph√°p Feynman*

---

## üìÅ **C·∫§U TR√öC C√ÅC FILE JAVASCRIPT**

```
js/
‚îú‚îÄ‚îÄ data.js    - Qu·∫£n l√Ω d·ªØ li·ªáu v√† LocalStorage
‚îú‚îÄ‚îÄ ui.js      - Qu·∫£n l√Ω giao di·ªán v√† hi·ªÉn th·ªã
‚îî‚îÄ‚îÄ app.js     - ƒêi·ªÅu ph·ªëi ch√≠nh v√† x·ª≠ l√Ω events
```

---

## üóÑÔ∏è **FILE: js/data.js**

### **M·ª•c ƒë√≠ch c·ªßa file:**
File n√†y ch·ªãu tr√°ch nhi·ªám qu·∫£n l√Ω t·∫•t c·∫£ d·ªØ li·ªáu c·ªßa ·ª©ng d·ª•ng, bao g·ªìm:
- L∆∞u tr·ªØ v√† l·∫•y d·ªØ li·ªáu t·ª´ LocalStorage 
- Th√™m giao d·ªãch m·ªõi (thu nh·∫≠p/chi ti√™u)
- Ch·ªânh s·ª≠a l∆∞∆°ng v√† t·ªâ l·ªá c√°c h·ªß
- Format s·ªë ti·ªÅn theo chu·∫©n Vi·ªát Nam

### **C√°c th√†nh ph·∫ßn ch√≠nh:**

#### 1. **DEFAULT_DATA - C·∫•u tr√∫c d·ªØ li·ªáu m·∫∑c ƒë·ªãnh**
```javascript
const DEFAULT_DATA = {
  salary: 0,           // L∆∞∆°ng hi·ªán t·∫°i
  ratios: {...},       // T·ªâ l·ªá % c√°c h·ªß
  jars: {...},         // S·ªë d∆∞ t·ª´ng h·ªß
  transactions: []     // Danh s√°ch giao d·ªãch
};
```
**Gi·∫£i th√≠ch:** ƒê√¢y l√† "khu√¥n m·∫´u" d·ªØ li·ªáu khi user m·ªõi b·∫Øt ƒë·∫ßu d√πng app. Gi·ªëng nh∆∞ t·ªù gi·∫•y tr·∫Øng ƒë·ªÉ ghi ch√©p t√†i ch√≠nh.

#### 2. **JAR_INFO - Th√¥ng tin hi·ªÉn th·ªã c√°c h·ªß**
```javascript
export const JAR_INFO = {
  debt: {
    name: 'N·ª£',
    color: '#ef4444',
    description: 'Ti·ªÅn chi ti√™u h√†ng ng√†y...'
  },
  // ... c√°c h·ªß kh√°c
};
```
**Gi·∫£i th√≠ch:** ƒê√¢y l√† "danh b·∫°" ch·ª©a t√™n, m√†u s·∫Øc, m√¥ t·∫£ c·ªßa t·ª´ng h·ªß ti·ªÅn. UI s·∫Ω d·ª±a v√†o ƒë√¢y ƒë·ªÉ hi·ªÉn th·ªã.

#### 3. **Function getData() - L·∫•y d·ªØ li·ªáu**
```javascript
export function getData() {
  const rawData = localStorage.getItem('money-tracker-data');
  if (!rawData) return JSON.parse(JSON.stringify(DEFAULT_DATA));
  return JSON.parse(rawData);
}
```
**Gi·∫£i th√≠ch theo Feynman:**
- Nh∆∞ vi·ªác m·ªü t·ªß l·∫°nh xem c√≥ g√¨
- `localStorage.getItem()` = m·ªü ngƒÉn t·ªß c√≥ nh√£n 'money-tracker-data'
- N·∫øu ngƒÉn t·ªß tr·ªëng (`!rawData`) = tr·∫£ v·ªÅ b·∫£n sao c·ªßa DEFAULT_DATA
- N·∫øu c√≥ d·ªØ li·ªáu = chuy·ªÉn t·ª´ chu·ªói JSON th√†nh object ƒë·ªÉ s·ª≠ d·ª•ng

#### 4. **Function setData() - L∆∞u d·ªØ li·ªáu**
```javascript
export function setData(data) {
  localStorage.setItem('money-tracker-data', JSON.stringify(data));
}
```
**Gi·∫£i th√≠ch theo Feynman:**
- Nh∆∞ vi·ªác c·∫•t ƒë·ªì v√†o t·ªß l·∫°nh
- Chuy·ªÉn object th√†nh chu·ªói JSON (ƒë√≥ng g√≥i)
- C·∫•t v√†o ngƒÉn t·ªß c√≥ nh√£n 'money-tracker-data'

#### 5. **Function addTransaction() - Th√™m giao d·ªãch**
```javascript
export function addTransaction(type, amount, jar, desc, date) {
  const data = getData();                    // L·∫•y d·ªØ li·ªáu hi·ªán t·∫°i
  const transaction = {                      // T·∫°o giao d·ªãch m·ªõi
    id: 'txn_' + Date.now(),
    type, amount, jar, desc, date
  };
  data.transactions.unshift(transaction);    // Th√™m v√†o ƒë·∫ßu danh s√°ch
  
  if (type === 'income') {
    data.jars[jar] += numAmount;             // Thu nh·∫≠p: c·ªông ti·ªÅn
  } else if (type === 'expense') {
    data.jars[jar] -= numAmount;             // Chi ti√™u: tr·ª´ ti·ªÅn
  }
  
  setData(data);                             // L∆∞u l·∫°i
  return transaction;
}
```
**Gi·∫£i th√≠ch theo Feynman:**
- Nh∆∞ vi·ªác ghi s·ªï s√°ch k·∫ø to√°n
- T·∫°o 1 d√≤ng ghi ch√©p m·ªõi v·ªõi ID duy nh·∫•t (d√πng timestamp)
- N·∫øu thu nh·∫≠p = c·ªông ti·ªÅn v√†o h·ªß ƒë√£ ch·ªçn
- N·∫øu chi ti√™u = tr·ª´ ti·ªÅn kh·ªèi h·ªß ƒë√£ ch·ªçn
- `unshift()` = th√™m v√†o ƒë·∫ßu m·∫£ng (giao d·ªãch m·ªõi nh·∫•t l√™n tr∆∞·ªõc)

#### 6. **Function editSalary() - Ch·ªânh s·ª≠a l∆∞∆°ng**
```javascript
export function editSalary(newSalary, newRatios) {
  const data = getData();
  data.salary = Number(newSalary);
  data.ratios = { ...newRatios };
  
  Object.keys(data.jars).forEach(jarName => {
    data.jars[jarName] = Math.round(data.salary * data.ratios[jarName] / 100);
  });
  
  setData(data);
}
```
**Gi·∫£i th√≠ch theo Feynman:**
- Nh∆∞ vi·ªác chia l·∫°i ng√¢n s√°ch gia ƒë√¨nh
- C·∫≠p nh·∫≠t l∆∞∆°ng m·ªõi v√† t·ªâ l·ªá % m·ªõi
- T√≠nh l·∫°i s·ªë ti·ªÅn cho t·ª´ng h·ªß: `l∆∞∆°ng √ó t·ªâ l·ªá √∑ 100`
- `Math.round()` = l√†m tr√≤n s·ªë ƒë·ªÉ kh√¥ng c√≥ s·ªë l·∫ª

#### 7. **C√°c helper functions**
```javascript
export function formatCurrency(amount) {
  return amount.toLocaleString('vi-VN') + ' ‚Ç´';
}
```
**Gi·∫£i th√≠ch:** Format s·ªë ti·ªÅn theo chu·∫©n Vi·ªát Nam (1.500.000 ‚Ç´)

---

## üé® **FILE: js/ui.js**

### **M·ª•c ƒë√≠ch c·ªßa file:**
File n√†y ch·ªãu tr√°ch nhi·ªám v·ªÅ giao di·ªán ng∆∞·ªùi d√πng:
- Hi·ªÉn th·ªã s·ªë d∆∞, bi·ªÉu ƒë·ªì, danh s√°ch giao d·ªãch
- Qu·∫£n l√Ω modal (popup)
- Render c√°c component UI

### **C√°c th√†nh ph·∫ßn ch√≠nh:**

#### 1. **Function updateBalanceDisplay() - C·∫≠p nh·∫≠t s·ªë d∆∞**
```javascript
export function updateBalanceDisplay() {
  const totalBalanceEl = document.getElementById('total-balance');
  const totalSalaryEl = document.getElementById('total-salary');
  
  const totalBalance = getTotalBalance();
  const salary = getSalary();
  
  totalBalanceEl.textContent = formatCurrency(totalBalance);
  totalSalaryEl.textContent = formatCurrency(salary);
}
```
**Gi·∫£i th√≠ch theo Feynman:**
- Nh∆∞ vi·ªác c·∫≠p nh·∫≠t b·∫£ng hi·ªÉn th·ªã s·ªë d∆∞ ATM
- L·∫•y element HTML c√≥ ID 'total-balance'
- L·∫•y s·ªë li·ªáu t·ª´ data module
- C·∫≠p nh·∫≠t n·ªôi dung hi·ªÉn th·ªã v·ªõi s·ªë ti·ªÅn ƒë√£ format

#### 2. **Function renderJarCards() - Render c√°c card h·ªß**
```javascript
export function renderJarCards() {
  const container = document.getElementById('jars-container');
  const jars = getJars();
  container.innerHTML = '';
  
  Object.entries(jars).forEach(([jarKey, balance]) => {
    const jarInfo = JAR_INFO[jarKey];
    const cardEl = document.createElement('div');
    cardEl.innerHTML = `<!-- HTML template -->`;
    container.appendChild(cardEl);
  });
}
```
**Gi·∫£i th√≠ch theo Feynman:**
- Nh∆∞ vi·ªác x·∫øp 6 c√°i h·ªß ti·ªÅn l√™n b√†n
- `Object.entries()` = bi·∫øn object th√†nh m·∫£ng [key, value]
- `document.createElement()` = t·∫°o element HTML m·ªõi
- Loop qua t·ª´ng h·ªß, t·∫°o card HTML, th√™m v√†o container

#### 3. **Function renderChart() - V·∫Ω bi·ªÉu ƒë·ªì**
```javascript
export function renderChart() {
  const canvas = document.getElementById('jar-chart');
  const ctx = canvas.getContext('2d');
  
  // Chu·∫©n b·ªã d·ªØ li·ªáu
  const chartData = [];
  const chartLabels = [];
  const chartColors = [];
  
  // T·∫°o chart v·ªõi Chart.js
  jarChart = new Chart(ctx, {
    type: 'doughnut',
    data: { labels: chartLabels, datasets: [{ data: chartData }] },
    options: { responsive: true }
  });
}
```
**Gi·∫£i th√≠ch theo Feynman:**
- Nh∆∞ vi·ªác v·∫Ω bi·ªÉu ƒë·ªì tr√≤n tr√™n gi·∫•y
- `getContext('2d')` = l·∫•y b√∫t v·∫Ω 2D tr√™n canvas
- Chu·∫©n b·ªã data th√†nh 3 m·∫£ng: s·ªë li·ªáu, nh√£n, m√†u s·∫Øc
- `new Chart()` = t·∫°o bi·ªÉu ƒë·ªì m·ªõi v·ªõi Chart.js library

#### 4. **Modal Management**
```javascript
export function showModal(modalId) {
  const modal = document.getElementById(modalId);
  modal.classList.remove('hidden');
}

export function hideModal(modalId) {
  const modal = document.getElementById(modalId);
  modal.classList.add('hidden');
}
```
**Gi·∫£i th√≠ch theo Feynman:**
- `showModal()` = m·ªü popup (remove class 'hidden')
- `hideModal()` = ƒë√≥ng popup (add class 'hidden')
- Nh∆∞ vi·ªác k√©o r√®m m·ªü/ƒë√≥ng c·ª≠a s·ªï

---

## ‚öôÔ∏è **FILE: js/app.js**

### **M·ª•c ƒë√≠ch c·ªßa file:**
File n√†y l√† "trung t√¢m ƒëi·ªÅu h√†nh" c·ªßa app:
- Kh·ªüi t·∫°o ·ª©ng d·ª•ng
- Bind events (g√°n s·ª± ki·ªán cho buttons)
- X·ª≠ l√Ω form submit
- ƒêi·ªÅu ph·ªëi gi·ªØa UI v√† Data

### **C√°c th√†nh ph·∫ßn ch√≠nh:**

#### 1. **Function initApp() - Kh·ªüi t·∫°o app**
```javascript
function initApp() {
  console.log('üöÄ Money Tracker App Starting...');
  updateAllUI();     // Render UI l·∫ßn ƒë·∫ßu
  bindEvents();      // G√°n events
  switchTab('dashboard'); // Hi·ªÉn th·ªã tab ch√≠nh
}
```
**Gi·∫£i th√≠ch theo Feynman:**
- Nh∆∞ vi·ªác kh·ªüi ƒë·ªông m√°y t√≠nh
- Hi·ªÉn th·ªã giao di·ªán ban ƒë·∫ßu
- K·∫øt n·ªëi c√°c n√∫t b·∫•m v·ªõi ch·ª©c nƒÉng
- M·ªü tab dashboard l√†m m·∫∑c ƒë·ªãnh

#### 2. **Function bindEvents() - G√°n s·ª± ki·ªán**
```javascript
function bindEvents() {
  document.getElementById('btn-add-income').addEventListener('click', () => {
    setupTransactionModal('income');
  });
  
  document.getElementById('btn-add-expense').addEventListener('click', () => {
    setupTransactionModal('expense');
  });
  // ... c√°c events kh√°c
}
```
**Gi·∫£i th√≠ch theo Feynman:**
- Nh∆∞ vi·ªác g·∫Øn chu√¥ng c·ª≠a
- `addEventListener()` = g·∫Øn "tai nghe" v√†o button
- Khi user click button = ch·∫°y function t∆∞∆°ng ·ª©ng
- M·ªói button c√≥ 1 nhi·ªám v·ª• ri√™ng

#### 3. **Event Handlers - X·ª≠ l√Ω s·ª± ki·ªán**

**handleTransactionSubmit():**
```javascript
function handleTransactionSubmit(e) {
  e.preventDefault();  // NgƒÉn form reload page
  
  // L·∫•y d·ªØ li·ªáu t·ª´ form
  const amount = document.getElementById('amount-input').value;
  const description = document.getElementById('description-input').value;
  // ...
  
  // Validate
  if (!amount || Number(amount) <= 0) {
    throw new Error('Vui l√≤ng nh·∫≠p s·ªë ti·ªÅn h·ª£p l·ªá');
  }
  
  // Th√™m giao d·ªãch
  addTransaction(type, amount, jar, description);
  
  // C·∫≠p nh·∫≠t UI
  updateAllUI();
  showToast('Th√†nh c√¥ng!');
}
```
**Gi·∫£i th√≠ch theo Feynman:**
- Nh∆∞ vi·ªác x·ª≠ l√Ω ƒë∆°n ƒë·∫∑t h√†ng
- `e.preventDefault()` = ngƒÉn form g·ª≠i ƒëi theo c√°ch m·∫∑c ƒë·ªãnh
- L·∫•y th√¥ng tin t·ª´ c√°c input fields
- Ki·ªÉm tra d·ªØ li·ªáu c√≥ h·ª£p l·ªá kh√¥ng
- N·∫øu OK = th√™m giao d·ªãch v√† c·∫≠p nh·∫≠t hi·ªÉn th·ªã

#### 4. **First Time User Setup**
```javascript
function checkFirstTimeUser() {
  const salary = getSalary();
  if (salary === 0) {
    setTimeout(() => {
      showToast('Ch√†o m·ª´ng b·∫°n!', 'info');
      setTimeout(() => {
        showModal('salary-modal');
      }, 1000);
    }, 500);
  }
}
```
**Gi·∫£i th√≠ch theo Feynman:**
- Nh∆∞ vi·ªác h∆∞·ªõng d·∫´n kh√°ch h√†ng m·ªõi
- Ki·ªÉm tra n·∫øu ch∆∞a c√≥ l∆∞∆°ng (= user m·ªõi)
- Hi·ªÉn th·ªã l·ªùi ch√†o + m·ªü popup nh·∫≠p l∆∞∆°ng
- `setTimeout()` = ƒë·∫∑t h·∫πn gi·ªù ƒë·ªÉ th·ª±c hi·ªán

---

## üîÑ **FLOW HO·∫†T ƒê·ªòNG T·ªîNG TH·ªÇ**

### **1. Kh·ªüi ƒë·ªông App:**
```
DOMContentLoaded ‚Üí initApp() ‚Üí updateAllUI() ‚Üí bindEvents()
```

### **2. Th√™m giao d·ªãch:**
```
Click button ‚Üí showModal() ‚Üí User nh·∫≠p form ‚Üí handleTransactionSubmit() 
‚Üí addTransaction() ‚Üí setData() ‚Üí updateAllUI() ‚Üí hideModal()
```

### **3. C·∫≠p nh·∫≠t l∆∞∆°ng:**
```
Click "Nh·∫≠p l∆∞∆°ng" ‚Üí loadSalaryData() ‚Üí showModal() ‚Üí User submit 
‚Üí handleSalarySubmit() ‚Üí editSalary() ‚Üí setData() ‚Üí updateAllUI()
```

### **4. Hi·ªÉn th·ªã d·ªØ li·ªáu:**
```
updateAllUI() ‚Üí updateBalanceDisplay() + renderJarCards() 
+ renderTransactionsList() + renderChart()
```

---

## üéØ **NGUY√äN T·∫ÆC THI·∫æT K·∫æ**

### **1. Separation of Concerns (T√°ch bi·ªát m·ªëi quan t√¢m):**
- **data.js:** Ch·ªâ lo v·ªÅ d·ªØ li·ªáu
- **ui.js:** Ch·ªâ lo v·ªÅ hi·ªÉn th·ªã
- **app.js:** Ch·ªâ lo v·ªÅ ƒëi·ªÅu ph·ªëi

### **2. Single Responsibility (M·ªôt tr√°ch nhi·ªám):**
- M·ªói function ch·ªâ l√†m 1 vi·ªác c·ª• th·ªÉ
- D·ªÖ debug, maintain, test

### **3. Error Handling (X·ª≠ l√Ω l·ªói):**
- Try-catch cho m·ªçi operation quan tr·ªçng
- Hi·ªÉn th·ªã th√¥ng b√°o l·ªói th√¢n thi·ªán cho user
- Console.log ƒë·ªÉ debug

### **4. User Experience:**
- Toast notifications cho feedback
- Modal ƒë·ªÉ nh·∫≠p li·ªáu
- Real-time update UI

---

## üîß **DEBUGGING TIPS**

### **Console Commands h·ªØu √≠ch:**
```javascript
// Xem d·ªØ li·ªáu hi·ªán t·∫°i
MoneyTracker.debugLog();

// Force update UI
MoneyTracker.updateUI();

// Xem raw data
localStorage.getItem('money-tracker-data');
```

### **Common Issues & Solutions:**
1. **UI kh√¥ng update:** Ki·ªÉm tra `updateAllUI()` c√≥ ƒë∆∞·ª£c g·ªçi sau thay ƒë·ªïi data
2. **Modal kh√¥ng ƒë√≥ng:** Ki·ªÉm tra event binding v√† CSS class 'hidden'
3. **Chart kh√¥ng hi·ªÉn th·ªã:** Ki·ªÉm tra canvas size v√† Chart.js data format
4. **LocalStorage full:** Implement data cleanup ho·∫∑c export feature

---

**üéâ K·∫øt lu·∫≠n:** Code ƒë∆∞·ª£c vi·∫øt theo nguy√™n t·∫Øc modular, d·ªÖ hi·ªÉu, d·ªÖ maintain. M·ªói file c√≥ tr√°ch nhi·ªám r√µ r√†ng, functions nh·ªè g·ªçn, c√≥ error handling ƒë·∫ßy ƒë·ªß.
